\section{Derivada de Schwarz}

\begin{definition}
Seja $f: \RR \to \RR$ uma função de classe $\CC^\infty$.  A derivada de Schwarz de $f$ é a função $\mathcal{S} f$ definida por
$$\mathcal{S} f(x) = \frac{\partial^3 f(x)}{\partial f(x)} - \frac{3}{2} \left( \frac{\partial^2 f(x)}{\partial f(x)} \right)^2$$
para todo $x$ tal que $\partial f(x) \neq 0$.
\end{definition}

\begin{lemma}
Se $\mathcal{S} f < 0$, então $\mathcal{S} f^j < 0$ para todo $j \geq 1$.
\end{lemma}

\begin{proof}
Se $\mathcal{S} f < 0$ e $\mathcal{S} g < 0$, vamos provar que $\mathcal{S} (f \circ g) < 0$. Pela Regra da Cadeia,
\begin{align*}
(f \circ g)'(x) & = f'(g(x))g'(x) \\
(f \circ g)''(x) & = f''(g(x))(g'(x))^2 + f'(g(x))g''(x) \\
(f \circ g)'''(x) & = f'''(g(x))(g'(x))^3 + 3f''(g(x))g''(x)g'(x) + f'(g(x))g'''(x)
\end{align*}
Desse modo,
\begin{align*}
\mathcal{S} (f \circ g)(x) & = \frac{(f \circ g)'''(x)}{(f \circ g)'(x)} - \frac{3}{2} \left( \frac{(f \circ g)''(x)}{(f \circ g)'(x)} \right)^2 \\
& = \frac{f'''(g(x))(g'(x))^2}{f'(g(x))} + 3\frac{f''(g(x))g''(x)}{f'(g(x))} + \frac{g'''(x)}{g'(x)} - \frac{3}{2}\left( \frac{f''(g(x))g'(x)}{f'(g(x))} + \frac{g''(x)}{g'(x)} \right)^2 \\
& = \mathcal{S} f(g(x)) (g'(x))^2 + \mathcal{S} g(x) < 0
\end{align*}
para todo $x$ tal que $(f \circ g)'(x) \neq 0$. Por indução, $S_{f^n} < 0$ para todo $n \geq 1$.
\end{proof}

\begin{lemma}
\label{lemma1}
Se $\mathcal{S} f < 0$ e $x_0$ é ponto de mínimo local de $f'$, então $f'(x_0) \leq 0$.
\end{lemma}

\begin{proof}
Se $f'(x_0) \neq 0$, então $\mathcal{S} f(x_0) = \frac{f'''(x_0)}{f'(x_0)} - \frac{3}{2} \frac{f''(x_0)}{f'(x_0)} < 0$. Sendo $x_0$ ponto de mínimo local de $f'$, temos que $f''(x_0) = 0$ e $f'''(x_0) \geq 0$. Portanto,  $f'(x_0) < 0$. 
\end{proof}

\begin{lemma}
\label{lemma2}
Se $\mathcal{S} f < 0$ e $a<b<c$ são pontos fixos de $f$, com $f'(b) \leq 1$, então $f$ possui ponto crítico em $(a, c)$.
\end{lemma}

\begin{proof}
Pelo Teorema do Valor Médio, existem $r \in (a,b)$ e $s \in (b,c)$  tais que $f'(r) = f'(s) = 1$. Sendo $f'$ contínua, $f'$ restrita ao intervalo $[r,s]$ possui mínimo global. Como $b \in (r,s)$ e $f'(b) \leq 1$, temos que $f'$ possui mínimo local em $(r,s)$. Utilizando Lema anterior e o Teorema do Valor Intermediário, a demonstração está concluída.
\end{proof}

\begin{lemma}
\label{lemma3}
Se $\mathcal{S} f < 0$ e $a<b<c<d$ são pontos fixos de $f$, então $f$ possui ponto crítico em $(a,d)$.
\end{lemma}

\begin{proof}
Se $f'(b) \leq 1$ ou $f'(c) \leq 1$, o resultado é verdadeiro pelo Lema anterior. Se $f'(b) > 1$ e $f'(c) > 1$, existem $r, t \in (b,c)$ tais que $r<t$, $f(r) > r$ e $f(t) < t$. Pelo Teorema do Valor Médio, existe $s \in (r,t)$ tal que $f'(s) < 1$. Portanto, $f'$ possui mínimo local em $(b,c)$. Utilizando Lema \ref{lemma1} e o Teorema do Valor Intermediário, a demonstração está concluída.
\end{proof}

\begin{lemma}
Se $f$ possui finitos pontos críticos, então $f^n$ possui finitos pontos críticos para todo $n \geq 1$.
\end{lemma}
\begin{proof}
%Inicialmente, vamos provar por indução que o conjunto $f^{-n}(c) = \{ x \in \RR : f^n(x) = c \}$ é finito para todo $n \geq 1$ e para todo $c \in \RR$.

Pelo Teorema do Valor Médio, $f$ possui ponto crítico entre dois elementos de $f^{-1}(c)$. Como $f$ possui finitos pontos críticos, $f^{-1}(c)$ é finito. Além disso, se $f^{-k}(c)$ é finito, então $f^{-(k+1)}(c) = \{ x \in \RR : f(f^k(x)) = c \}$ é finito pois $f^{-1}(c)$ é finito e, por hipótese de indução, $f^{-k}(c_ i)$ é finito para cada $c_i \in f^{-1}(c)$. Portanto, $f^{-n}(c)$ é finito para todo $n \geq 1$.

Temos que $(f^n)'(x) = \prod_{k=0}^{n-1} f'(f^k(x)) = 0$ se e somente se $f^k(x)$ é ponto crítico de $f$ para algum $k = 1, \dots, n-1$. Assim, o conjunto de pontos críticos de $f^n$ é finito pois é dado pela união dos conjuntos $\cup_{k=0}^{n-1} f^{-k}(c_i)$, onde $c_i$ é ponto crítico de $f$.
\end{proof}

Observe que o Lema anterior, ao contrário dos outros, não exige que $\mathcal{S} f < 0$.
%
%\begin{lemma}
%Se $\mathcal{S} f < 0$ e $f$ possui finitos pontos críticos, então $f^n$ possui finitos pontos fixos para todo $n \geq 1$.
%\end{lemma}
%\begin{proof}
%Se $f^n$ possui infinitos pontos fixos para algum $n > 1$, então $f^n$ possui infinitos pontos críticos de acordo com o Lema \ref{lemma3}. Essa implicação contradiz o Lema anterior.
%\end{proof}
%

%Para demonstrar os próximos resultados, seja $p$ um ponto fixo de $g$ tal que $|g'(p)| \leq 1$. Defina $K_p$ a componente conexa $B(p) = \{ x \in \RR : \lim_{k \to \infty} g^k(x) = p \}$ que contém $p$.
%
%\begin{lemma}
%Seja $p$ um ponto fixo de $g$ tal que $|g'(p)| < 1$. Se $K_p$ é limitado, então $K_p$ é aberto, $g(K_p) \subset K_p$.
%\end{lemma}
%
%\begin{proof}
%Como $g'$ é contínua, existe $\varepsilon > 0$ tal que $|g'(x)| < 1$ para todo $x \in V = (p - \varepsilon, p + \varepsilon)$. Pelo Teorema do Valor Médio, $V \subset B(p)$. Observe também que para todo $x \in K_p$, existe $n \geq 1$ tal que $g^n(x) \in V$.
%
%Sendo $p$ um ponto fixo, considere $g^{-n}(V)^*$ a componente conexa de $g^{-n}(V)$ que contém $p$. Observe que $g^{-n}(V)^*$ é aberto, pois $g^{-n}(V)$ é aberto e componente conexa de aberto é aberto. Vamos provar que $K_p = \cup_{n=0}^{\infty} g^{-n}(V)^*$.
%
%Desse modo, $K_p$ é aberto pois é união de abertos, e $g(K_p) \subset K_p$ por construção.
%\end{proof}

\begin{theorem}[Singer]
Se $\mathcal{S} f < 0$ e $f$ possui $n$ pontos críticos, então $f$ possui no máximo $n+2$ órbitas periódicas não repulsoras.
\end{theorem}

\begin{proof}
Sejam $p$ um ponto periódico não repulsor de $f$ de período $m$ e $g = f^m$. Desse modo, $p$ é um ponto fixo não repulsor de $g$, ou seja, $g(p) = p$ e $|g'(p)| \leq 1$. Seja $K$ a componente conexa de $B(p) = \{ x : \lim_{k \to \infty} g^k(x) = p \}$ que contém $p$.

Suponha que $K$ é limitado e $|g'(p)| < 1$. Vamos mostrar que $K$ é aberto, $g(K) \subset K$ e $g$ preserva os pontos extremos de $K$.

Como $|g'(p)| < 1$, $p$ é um ponto atrator e, portanto, existe uma vizinhança $V$ de $p$ contida em $B(p)$. Além disso, $g(\bar{V}) \subset V$. Sendo $g$ contínua, $g^{-n}(V)$ é um aberto que contém $p$ para todo $n \geq 1$. Como $g^n(p) = p \in V$, considere $g^{-n}(V)^*$ a componente conexa de $g^{-n}(V)$ que contém $p$.

Observe que, se $x \in K$, existe $n \geq 1$ tal que $g^n(x) \in V$. Desse modo, podemos escrever $K = \cup^{\infty}_{n = 0} \ g^{-n}(V)^*$. Portanto, $K$ é aberto e, por construção, $g(K) \subset K$.

Seja $a$ um ponto extremo de $K$ e suponha que $g(a) \in K$. Desse modo, existe uma vizinhança $V$ de $g(a)$ contida em $K$. Sendo $g$ contínua, $g^{-1}(V)$ é uma vizinhança de $a$ contida $B(p)$, o que contraria o fato de $K$ ser a componente conexa de $B(p)$ que contém $p$. Como $g(K) \subset K$ e $g$ é contínua, concluímos que $g$ preserva os pontos extremos de $K$.

Desse modo, escrevendo $K = (a, b)$, ocorre um dos três casos abaixo. Vamos mostrar que em cada caso, $g$ possui ponto crítico em $K$. Observe que $\mathcal{S} g < 0$.

\begin{enumerate}

\item[a)] Se $g(a) = a$ e $g(b) = b$, $g$ possui ponto crítico em $K$ pelo Lema \ref{lemma2}.
\item[b)] Se $g(a) = b$ e $g(b) = a$,  considerando $h = g^2$ e utilizando novamente o Lema \ref{lemma2}, $h$ possui ponto crítico em $K$. Como $g(K) \subset K$, $g$ possui ponto crítico em $K$.
\item[c)] Se $g(a) = g(b)$, $g$ possui ponto crítico em $K$ pelo Teorema do Valor Médio.
\end{enumerate}

Suponha que $K$ é limitado e $|g'(p)| = 1$. Pelo Lema anterior, $g$ possui finitos pontos fixos e, portanto, são isolados.

Se $g'(p) = 1$ e, para $x$ numa vizinhança de $p$, $g(x) > x$ quando $x > p$ e $g(x) < x$ quando $x < p$, então $g'(x^*) > 0$, para $x^*$ próximo de $p$, é um mínimo local de $g'$ maior que zero, o que contradiz o Lema \ref{lemma1}. Se $g'(p)=-1$, basta considerar $h=g^2$ e obter o mesmo resultado. Portanto, $p$ é atrator em pelo menos um dos lados. Desse modo, $K$ é um intervalo não trivial, $g(K) \subset K$ e $g$ preserva os pontos extremos de $K$. Assim, é possível concluir de maneira análoga que $g$ possui ponto crítico em $K$.

Pela Regra da Cadeia, se $g$ possui ponto crítico $x_0 \in K$, então $f^i(x_0)$ é ponto crítico de $f$ para algum $i = 0, \dots, m-1$. Desse modo, se $p$ é um ponto periódico não repulsor de $f$ cujo intervalo associado $K$ é limitado, então $K$ possui pelo menos um ponto crítico e, como existem $n$ pontos críticos, existem no máximo $n$ intervalos $K$ limitados. Não é possível obter a mesma conclusão se $K$ não é limitado, mas observando que existem no máximo dois intervalos desse tipo, a demonstração está concluída.
\end{proof}

\begin{corollary}
$F_\mu(x) = \mu x(1-x)$, $\mu > 0$, possui no máximo 1 órbita periódica não repulsora.
\end{corollary}

\begin{proof}
Observe que $F_\mu$ possui um único ponto crítico em $\frac{1}{2}$. Pelo Teorema de Singer, $F_\mu$ possui no máximo 3 órbitas periódicas não repulsoras. Se $p$ é ponto fixo de $F_\mu$ e observando que $\lim_{n \to\infty} |F^n_\mu(x)| = \infty$ quando $|x|$ é suficientemente grande, concluímos que $B(p)$ é limitado. Portanto, $F_\mu$ possui no máximo 1 órbita periódica não repulsora.
\end{proof}
